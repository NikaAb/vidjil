{{from gluon.contrib.markdown.markdown2 import markdown}}
{{extend 'db_layout.html'}}

<h3>{{=query.title if query is not None else message}}</h3>

{{if query is not None:}}
    <div class="db_block info_block">
        {{=XML(markdown(query.message_content))}}
    </div>
{{pass}}

<div id="db_table_container" {{if query is not None:}}class="info_table"{{pass}}>
    <table class="db_table" id="table">

        <thead>
            <tr>
                <td class="column_100"> Creator </td>
            	<td class="column_100"> Type </td>
                <td class="column_100"> Priority </td>
                <td class="column_100"> Title </td>
                <td class="column_100"> Message </td>
                <td class="column_100"> Expiration Date </td>                
            {{if auth.is_admin():}} 
                <td class="column5"> </td>
                <td class="column5"> </td>
            {{pass}}
            </tr>
        </thead>
        
        <tbody>
        {{for row in notifications:}}
            <tr>
                <td class="pointer" onclick="db.call('notification/info', {'id' : '{{=row.id}}'})">
                    {{=row.creator}}
                </td>
                <td class="pointer" onclick="db.call('notification/info', {'id' : '{{=row.id}}'})">
                    {{=row.message_type}}
                </td>
                <td class="pointer" onclick="db.call('notification/info', {'id' : '{{=row.id}}'})">
                    {{=row.priority}}
                </td>
                <td class="pointer" onclick="db.call('notification/info', {'id' : '{{=row.id}}'})">
                    {{=row.title}}
                </td>
                <td class="pointer" onclick="db.call('notification/info', {'id' : '{{=row.id}}'})">
                    {{=row.message_content}}
                </td>
                <td class="pointer" onclick="db.call('notification/info', {'id' : '{{=row.id}}'})">
                    {{=row.expiration}}
                </td>
            {{if auth.is_admin():}}
                <td class="pointer" onclick="db.call('notification/edit', {'id' : '{{=row.id}}'})">
                    e
                </td>
                <td class="pointer" onclick="db.call('notification/delete', {'id' : '{{=row.id}}'})">
                    X
                </td>
            {{pass}}
            </tr>
        {{pass}}
        </tbody>
    </table>
    <table class="db_table" id="db_fixed_header"></table>
</div>

{{if auth.is_admin():}}
    <span class="button2" onclick="db.call('notification/add')"> + new notification </span>
{{pass}}
